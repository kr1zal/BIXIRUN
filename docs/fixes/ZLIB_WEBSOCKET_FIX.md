# üîß –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ ZLIB –í WEBSOCKET

## ‚ùå –ù–û–í–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–π WebSocket –æ—à–∏–±–∫–∏ –ø–æ—è–≤–∏–ª–∞—Å—å –Ω–æ–≤–∞—è:
```
The package at "node_modules/ws/lib/permessage-deflate.js" attempted to import the Node standard library module "zlib".
It failed because the native React runtime does not include the Node standard library.
```

## üîç –ü–†–ò–ß–ò–ù–ê
- WebSocket –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `ws` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `permessage-deflate` –¥–ª—è —Å–∂–∞—Ç–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ú–æ–¥—É–ª—å `permessage-deflate` —Ç—Ä–µ–±—É–µ—Ç `zlib` –¥–ª—è —Å–∂–∞—Ç–∏—è/—Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏
- –í React Native –Ω–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ `zlib` –º–æ–¥—É–ª—è

## ‚úÖ –†–ï–®–ï–ù–ò–Ø

### –†–µ—à–µ–Ω–∏–µ 1: –î–æ–±–∞–≤–∏—Ç—å zlib –ø–æ–ª–∏—Ñ–∏–ª (–í–´–ü–û–õ–ù–ï–ù–û)
```js
// metro.config.js
config.resolver.extraNodeModules = {
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª–∏—Ñ–∏–ª—ã
    zlib: require.resolve('browserify-zlib'),
};

// app/polyfills.ts
if (typeof (globalThis as any).zlib === 'undefined') {
    (globalThis as any).zlib = require('browserify-zlib');
}
```

### –†–µ—à–µ–Ω–∏–µ 2: –û—Ç–∫–ª—é—á–∏—Ç—å WebSocket —Å–∂–∞—Ç–∏–µ (–í–´–ü–û–õ–ù–ï–ù–û)
```js
// app/supabaseClient.ts
export const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
    realtime: {
        params: {
            'per-message-deflate': false, // –û—Ç–∫–ª—é—á–∞–µ–º —Å–∂–∞—Ç–∏–µ
        },
    },
});
```

### –†–µ—à–µ–Ω–∏–µ 3: –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å Realtime (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω)
```js
export const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
    realtime: {
        disabled: true, // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∞–µ–º WebSocket
    },
});
```

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –†–ï–®–ï–ù–ò–ô

| –†–µ—à–µ–Ω–∏–µ | –†–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞ | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å |
|---------|---------------|-------------------|------------------|
| **zlib –ø–æ–ª–∏—Ñ–∏–ª** | +50KB | –ù–æ—Ä–º–∞–ª—å–Ω–∞—è | –ü–æ–ª–Ω–∞—è |
| **–ë–µ–∑ —Å–∂–∞—Ç–∏—è** | –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π | –ë—ã—Å—Ç—Ä–µ–µ | –ü–æ–ª–Ω–∞—è |
| **–ë–µ–∑ Realtime** | -200KB | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è |

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –†–µ—à–µ–Ω–∏–µ 2** (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–∂–∞—Ç–∏—è):
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞
- ‚úÖ –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–µ—Ç —Å–∂–∞—Ç–∏—è/—Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Supabase
- ‚úÖ –ò–∑–±–µ–≥–∞–µ–º –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–ª–∏—Ñ–∏–ª–∞–º–∏

## üîß –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

–ü—Ä–∏–º–µ–Ω–µ–Ω—ã **–æ–±–∞ —Ä–µ—à–µ–Ω–∏—è** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `zlib` –ø–æ–ª–∏—Ñ–∏–ª
2. ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–æ WebSocket —Å–∂–∞—Ç–∏–µ
3. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

## ‚ö†Ô∏è –í–ê–ñ–ù–û

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è WebSocket —Å–∂–∞—Ç–∏–µ:
1. –£–±—Ä–∞—Ç—å `'per-message-deflate': false`
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `browserify-zlib` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## üì± –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- [x] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Realtime —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)
- [ ] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–ª–∞ 